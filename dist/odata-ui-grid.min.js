/**
 * odata-ui-grid - 0.0.2
 * odata uiGrid
 * 
 * 
 * Released under the MIT license.
 * Copyright 2016 Rodrigo Pimentel and contributors.
 */
var OdataUiGrid;!function(a){"use strict";var b=function(){function a(){}return a.main=angular.module("odata.ui.grid",["ODataResources","ui.grid","ui.grid.pagination"]),a}();a.Modules=b,b.main.run(["$templateCache",function(a){var b=a.get("ui-grid/uiGridHeaderCell").toString();b=b.replace(/ui\-grid\-filter/gi,"odata-ui-grid-filter"),a.put("ui-grid/uiGridHeaderCell",b)}])}(OdataUiGrid||(OdataUiGrid={}));var OdataUiGrid;!function(a){var b;!function(b){"use strict";var c=function(){function a(a,b,c,d,e,f){this.priority=-200,this.restrict="A",this.scope=!1,this.require="uiGrid",this.filterTermMappings={},this.paginationOptions={page:1,paginationPageSizes:[25,50,75],paginationPageSize:25,sort:""};var g=this;this.link=function(a,h,i,j){function m(){g.filterTermMappings[f.filter.STARTS_WITH]="startswith",g.filterTermMappings[f.filter.ENDS_WITH]="endswith",g.filterTermMappings[f.filter.EXACT]="eq",g.filterTermMappings[f.filter.CONTAINS]="contains",g.filterTermMappings[f.filter.GREATER_THAN]="gt",g.filterTermMappings[f.filter.GREATER_THAN_OR_EQUAL]="ge",g.filterTermMappings[f.filter.LESS_THAN]="lt",g.filterTermMappings[f.filter.LESS_THAN_OR_EQUAL]="le"}function n(){var b=a.$eval(i.odataUiGridQueryOptions),c=a.$eval(i.uiGrid);if(c){c.useExternalPagination=!0,c.useExternalFiltering=!0,c.useExternalSorting=!0;var d=c.onRegisterApi;c.onRegisterApi=function(e){d&&d(e),b.$currentQuery={gridApi:e,provider:b.resource.odata(),predicate:b.predicate,expand:b.expand,select:b.select,skip:b.skip,take:b.take,sort:b.sort,sortDirection:b.sortDirection},e.core.on.sortChanged(a,function(a,c){angular.noop(a),p(b)}),e.core.on.filterChanged(a,function(){p(b)}),e.pagination&&(c.currentPage=c.currentPage||g.paginationOptions.page,c.paginationPageSize=c.paginationPageSize||g.paginationOptions.paginationPageSize,c.paginationPageSizes=c.paginationPageSizes||g.paginationOptions.paginationPageSizes,e.pagination.on.paginationChanged(a,function(a,d){c.currentPage=a,c.paginationPageSize=d,p(b)})),b.preventInitialLoad||p(b)}}}function o(a){var c=a.$currentQuery.gridApi,d=c.grid.options;if(a.$currentQuery.skip=(d.currentPage-1)*d.paginationPageSize,a.$currentQuery.take=d.paginationPageSize,c&&d){var e=function(a){b(function(){void 0!==a&&void 0!==a.count&&(d.totalItems=a.count,c.grid.appScope[d.data]=a)})},f=function(){angular.noop()};t(a,g.filterTermMappings).then(e,f)}}function p(a){l&&(b.cancel(l),l=null),l=b(function(a){q(a),r(a),o(a)},a.debounceDelay,!0,a)}function q(a,b){if(!a||!a.resource)throw new Error("Need a valid odataUiGridQueryOptions object with a valid resource.");var c={gridApi:b||a.$currentQuery.gridApi,provider:a.resource.odata(),predicate:a.predicate,expand:a.expand,select:a.select,skip:a.skip,take:a.take,sort:a.sort,sortDirection:a.sortDirection};a.$currentQuery=c}function r(a){var b=a.$currentQuery.gridApi.grid.columns.filter(function(a){return Object.keys(a.sort).length});b.sort(function(a,b){return a.sort.priority===b.sort.priority?0:a.sort.priority>b.sort.priority?1:-1}).some(function(b,c){return a.$currentQuery.sort=b.field?b.field.replace(".","/"):null,a.$currentQuery.sortDirection=b.sort.direction,!0})}function s(a,b,c,e){if(c=c.replace(".","/"),-1!==["startswith","endswith"].indexOf(b))a.$currentQuery.provider=a.$currentQuery.provider.filter(new d.Func(b,new d.Property(c),new d.Value(e)),!0);else if("contains"===b)a.$currentQuery.provider=a.$currentQuery.provider.isv4?a.$currentQuery.provider.filter(new d.Func("contains",new d.Property(c),new d.Value(e))):a.$currentQuery.provider.filter(new d.Func("substringof",new d.Value(e),new d.Property(c)));else{e=isNaN(e)?e:parseInt(e,10);var f=new d.Predicate(c,b,e);a.$currentQuery.predicate=a.$currentQuery.predicate?a.$currentQuery.predicate.and(f):f}}function t(a,b){k&&k();var d=function(a){return void 0!==a.term&&null!==a.term&&""!==a.term.toString().trim()},e=a.$currentQuery.gridApi.grid;e.columns.filter(function(a){var b=!1;return e&&e.options&&e.options.enableFiltering&&(b=a&&a.filters&&a.filters.length&&a.filters.some(d)),b}).forEach(function(c){c.filters&&c.filters.forEach(function(e){e&&void 0!==b[e.condition]&&d(e)&&s(a,b[e.condition],c.field,e.term)})});var f=a.$currentQuery.provider;a.$currentQuery.predicate&&(f=f.filter(a.$currentQuery.predicate)),a.$currentQuery.select&&(f=f.select(a.$currentQuery.select)),a.$currentQuery.expand&&a.$currentQuery.expand.length&&a.$currentQuery.expand.forEach(function(a){f=f.expand(a)}),a.$currentQuery.skip&&(f=f.skip(a.$currentQuery.skip)),a.$currentQuery.take&&(f=f.take(a.$currentQuery.take)),a.$currentQuery.sort&&(f=f.orderBy(a.$currentQuery.sort,a.$currentQuery.sortDirection)),a.$currentQuery.provider=f;var g=c(function(a,b){k=function(){b(),k=null},f.withInlineCount().query(function(b){k=null,a(b)},function(){k=null,b()})});return g}angular.noop(a,h,i,e);var k,l;m(),n()}}return a.$inject=["$compile","$timeout","$q","$odata","$odataresource","uiGridConstants"],a}();b.OdataUiGrid=c,a.Modules.main.directive("odataUiGrid",["$compile","$timeout","$q","$odata","$odataresource","uiGridConstants",function(a,b,d,e,f,g){return new c(a,b,d,e,f,g)}])}(b=a.Base||(a.Base={}))}(OdataUiGrid||(OdataUiGrid={}));var OdataUiGrid;!function(a){var b;!function(b){"use strict";var c=function(){function a(b,c,d){this.restrict="AE",this.scope=!1,this.compile=function(){return{pre:function(d,e,f){function h(){var b=!1;return d.col&&d.col.filters&&(b=d.col.filters.some(function(b){return-1!==a.customFiltersProvided.indexOf(b.type)})),b}angular.noop(f);var g=d.col.grid.options&&d.col.grid.options.useExternalFiltering&&h()?c.get("lib/directives/odataUiGridFilterView.html"):"<div ui-grid-filter></ui-grid-filter>";e.html(""),e.append(b(angular.element(g))(d))}}}}return a.customFiltersProvided=["date"],a.$inject=["$compile","$templateCache","uiGridConstants"],a}();b.OdataUiGridFilter=c,a.Modules.main.directive("odataUiGridFilter",["$compile","$templateCache","uiGridConstants",function(a,b,d){return new c(a,b,d)}])}(b=a.Base||(a.Base={}))}(OdataUiGrid||(OdataUiGrid={}));